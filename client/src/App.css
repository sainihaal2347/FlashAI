/* VARIABLES & RESET */
:root {
  --primary: #6366f1;
  --primary-hover: #4f46e5;
  --bg-light: #f3f4f6;
  --bg-dark: #0f172a;
  --card-light: #ffffff;
  --card-dark: #1e293b;
  --text-light: #1e293b;
  --text-dark: #f8fafc;
  --sidebar-w: 260px;
}

body { margin: 0; font-family: 'Inter', sans-serif; background-color: var(--bg-light); color: var(--text-light); transition: background 0.3s, color 0.3s; overflow-x: hidden; }
* { box-sizing: border-box; }

/* --- LAYOUT --- */
.app-layout { display: flex; height: 100vh; width: 100vw; overflow: hidden; }

/* SIDEBAR */
.sidebar { width: var(--sidebar-w); background: white; border-right: 1px solid #e5e7eb; display: flex; flex-direction: column; padding: 20px; z-index: 50; transition: 0.3s; }
.sidebar-top { margin-bottom: 40px; }
.app-logo { display: flex; align-items: center; gap: 12px; font-weight: 800; font-size: 1.5rem; color: var(--primary); letter-spacing: -0.5px; }
.logo-icon { width: 40px; height: 40px; background: linear-gradient(135deg, #6366f1, #a855f7); color: white; border-radius: 12px; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 10px rgba(99, 102, 241, 0.3); }

.nav-links { display: flex; flex-direction: column; gap: 8px; flex: 1; }
.nav-item { display: flex; align-items: center; gap: 12px; padding: 12px 16px; border-radius: 12px; border: none; background: transparent; color: #64748b; font-weight: 600; cursor: pointer; transition: 0.2s; font-size: 1rem; text-align: left; }
.nav-item:hover { background: #f1f5f9; color: var(--primary); }
.nav-item.active { background: #e0e7ff; color: var(--primary); }

.sidebar-bottom { position: relative; border-top: 1px solid #e5e7eb; padding-top: 20px; }
.user-profile { display: flex; align-items: center; gap: 10px; cursor: pointer; padding: 10px; border-radius: 12px; transition: 0.2s; }
.user-profile:hover { background: #f8fafc; }
.user-avatar-small { width: 36px; height: 36px; background: linear-gradient(135deg, #3b82f6, #06b6d4); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 0.9rem; }
.user-info { display: flex; flex-direction: column; flex: 1; }
.user-name { font-weight: 600; font-size: 0.9rem; color: #334155; }
.user-role { font-size: 0.75rem; color: #94a3b8; }
.user-chevron { color: #cbd5e1; }

/* DROPDOWN STYLING - UPDATED */
.user-dropdown {
  position: absolute;
  bottom: 80px;
  left: 10px;
  right: 10px;
  background: white;
  border-radius: 16px;
  box-shadow: 0 10px 40px rgba(0,0,0,0.1);
  border: 1px solid #e2e8f0;
  overflow: hidden;
  animation: slideUp 0.2s cubic-bezier(0.16, 1, 0.3, 1);
  z-index: 100;
  padding: 6px;
}

.dropdown-item { display: flex; align-items: center; gap: 10px; padding: 12px 16px; cursor: pointer; font-size: 0.9rem; color: #475569; transition: 0.2s; border-radius: 8px; }
.dropdown-item:hover { background: #f1f5f9; color: var(--primary); transform: translateX(2px); }
.dropdown-divider { height: 1px; background: #e2e8f0; margin: 4px 0; }
.dropdown-item.danger { color: #ef4444; }
.dropdown-item.danger:hover { background: #fef2f2; }

/* MAIN CONTENT */
.main-content { flex: 1; overflow-y: auto; padding: 40px; }
.page-container { max-width: 900px; margin: 0 auto; animation: fadeIn 0.3s ease-out; }
.fade-in { animation: fadeIn 0.3s ease-out; }

.page-header { text-align: center; margin-bottom: 40px; }
.page-header.left-align { text-align: left; display: flex; justify-content: space-between; align-items: flex-end; border-bottom: 1px solid #e2e8f0; padding-bottom: 20px; }
.page-header h2 { font-size: 2rem; margin: 0 0 10px; color: #1e293b; display: flex; align-items: center; justify-content: center; gap: 10px; }
.page-header.left-align h2 { justify-content: flex-start; }
.page-header p { color: #64748b; margin: 0; font-size: 1.1rem; }

/* MOBILE TOP BAR */
.mobile-top-bar { display: none; margin-bottom: 20px; justify-content: center; }

/* CREATE PAGE STYLES */
.create-card-wrapper { background: white; padding: 40px; border-radius: 24px; box-shadow: 0 10px 40px rgba(0,0,0,0.05); }
textarea { width: 100%; height: 200px; padding: 20px; border: 2px solid #e2e8f0; border-radius: 16px; font-size: 1.1rem; font-family: inherit; resize: none; transition: 0.2s; outline: none; margin-bottom: 30px; background: #f8fafc; }
textarea:focus { border-color: var(--primary); background: white; box-shadow: 0 0 0 4px rgba(99, 102, 241, 0.1); }

.controls-row { display: flex; align-items: center; justify-content: space-between; gap: 20px; }
.slider-container { flex: 1; background: #f1f5f9; padding: 15px 25px; border-radius: 16px; display: flex; align-items: center; gap: 20px; }
.slider-label { display: flex; align-items: center; gap: 8px; font-weight: 600; color: #475569; white-space: nowrap; width: 100px; }
.slider-container input[type="range"] { flex: 1; height: 6px; background: #cbd5e1; border-radius: 10px; appearance: none; cursor: pointer; }
.slider-container input[type="range"]::-webkit-slider-thumb { appearance: none; width: 20px; height: 20px; background: var(--primary); border-radius: 50%; cursor: pointer; transition: transform 0.1s; }
.slider-container input[type="range"]::-webkit-slider-thumb:hover { transform: scale(1.2); }

.generate-btn { background: linear-gradient(135deg, #6366f1, #8b5cf6); color: white; border: none; padding: 16px 32px; border-radius: 16px; font-weight: 700; font-size: 1.1rem; cursor: pointer; display: flex; align-items: center; gap: 10px; transition: 0.2s; box-shadow: 0 4px 15px rgba(99, 102, 241, 0.3); }
.generate-btn:hover:not(:disabled) { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(99, 102, 241, 0.4); }
.generate-btn:disabled { opacity: 0.7; cursor: wait; }

/* LIBRARY GRID */
.deck-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(260px, 1fr)); gap: 25px; margin-top: 30px; }
.deck-card { background: white; padding: 25px; border-radius: 20px; cursor: pointer; position: relative; border: 1px solid #f1f5f9; transition: 0.3s; display: flex; flex-direction: column; height: 200px; box-shadow: 0 4px 6px rgba(0,0,0,0.02); }
.deck-card:hover { transform: translateY(-5px); box-shadow: 0 15px 30px rgba(0,0,0,0.08); border-color: #e0e7ff; }
.deck-icon { width: 50px; height: 50px; background: #e0e7ff; color: var(--primary); border-radius: 14px; display: flex; align-items: center; justify-content: center; margin-bottom: 20px; }
.deck-title { margin: 0; font-size: 1.2rem; font-weight: 700; color: #1e293b; overflow: hidden; text-overflow: ellipsis; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; flex: 1; }
.deck-count { color: #94a3b8; font-weight: 500; font-size: 0.9rem; margin: 0; }
.delete-btn { position: absolute; top: 20px; right: 20px; color: #cbd5e1; padding: 8px; border-radius: 8px; transition: 0.2s; }
.delete-btn:hover { background: #fef2f2; color: #ef4444; }
.deck-arrow { position: absolute; bottom: 25px; right: 25px; color: var(--primary); opacity: 0; transform: translateX(-10px); transition: 0.3s; }
.deck-card:hover .deck-arrow { opacity: 1; transform: translateX(0); }

/* STUDY MODE */
.study-nav { display: flex; align-items: center; justify-content: space-between; margin-bottom: 40px; }
.back-btn { background: white; border: 1px solid #e2e8f0; color: #64748b; padding: 10px 20px; border-radius: 30px; cursor: pointer; font-weight: 600; display: flex; align-items: center; gap: 8px; transition: 0.2s; }
.back-btn:hover { background: #f1f5f9; color: #1e293b; }
.study-title { margin: 0; font-size: 1.5rem; text-align: center; color: #1e293b; }

.flashcard-container { max-width: 600px; margin: 0 auto; perspective: 1000px; }
.flashcard { height: 400px; background: white; border-radius: 30px; display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 40px; text-align: center; cursor: pointer; position: relative; box-shadow: 0 20px 60px rgba(0,0,0,0.08); border: 1px solid #f8fafc; transition: transform 0.1s; }
.flashcard:active { transform: scale(0.98); }
.flashcard.front { background: white; }
.flashcard.back { background: linear-gradient(135deg, #6366f1, #8b5cf6); color: white; }
.card-content { flex: 1; display: flex; flex-direction: column; justify-content: center; }
.card-label { font-size: 0.85rem; font-weight: 800; text-transform: uppercase; letter-spacing: 2px; color: #cbd5e1; margin-bottom: 20px; display: block; }
.flashcard.back .card-label { color: rgba(255,255,255,0.6); }
.flashcard p { font-size: 1.5rem; font-weight: 500; line-height: 1.6; margin: 0; }
.tap-hint { position: absolute; bottom: 30px; font-size: 0.9rem; color: #94a3b8; display: flex; align-items: center; gap: 6px; font-weight: 500; }

.study-controls { display: flex; justify-content: center; align-items: center; gap: 30px; margin-top: 40px; }
.nav-btn { width: 56px; height: 56px; border-radius: 50%; border: none; background: white; color: #1e293b; box-shadow: 0 10px 20px rgba(0,0,0,0.05); cursor: pointer; display: flex; align-items: center; justify-content: center; transition: 0.2s; }
.nav-btn:hover:not(:disabled) { transform: translateY(-3px); box-shadow: 0 15px 30px rgba(0,0,0,0.1); color: var(--primary); }
.nav-btn:disabled { opacity: 0.5; cursor: not-allowed; }
.page-indicator { font-weight: 700; color: #94a3b8; font-size: 1.1rem; }

/* AUTH PAGE */
.auth-container { height: 100vh; display: flex; align-items: center; justify-content: center; background: #f8fafc; }
.auth-content { display: flex; gap: 60px; align-items: center; max-width: 1000px; width: 90%; }
.auth-header { flex: 1; }
.auth-header h1 { font-size: 4rem; margin: 0; background: linear-gradient(135deg, #6366f1, #a855f7); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
.auth-header p { font-size: 1.5rem; color: #64748b; margin-top: 10px; }
.big-logo { color: var(--primary); margin-bottom: 20px; }
.auth-form-box { flex: 1; background: white; padding: 50px; border-radius: 30px; box-shadow: 0 20px 60px rgba(0,0,0,0.05); max-width: 450px; }
.auth-form-box h2 { margin: 0 0 30px; font-size: 2rem; color: #1e293b; }
.input-group { margin-bottom: 20px; }
.input-group input { width: 100%; padding: 18px; border: 2px solid #f1f5f9; border-radius: 14px; font-size: 1rem; outline: none; transition: 0.2s; background: #f8fafc; }
.input-group input:focus { border-color: var(--primary); background: white; }
.auth-submit-btn { width: 100%; padding: 18px; background: var(--primary); color: white; border: none; border-radius: 14px; font-weight: 700; font-size: 1.1rem; cursor: pointer; transition: 0.2s; }
.auth-submit-btn:hover { background: var(--primary-hover); transform: translateY(-2px); }

.switch-text { margin-top: 20px; color: #64748b; font-size: 0.95rem; cursor: pointer; transition: 0.2s; }
.switch-text:hover { color: #2563eb; text-decoration: underline; }

/* EMPTY STATES */
.empty-state { text-align: center; margin-top: 100px; color: #94a3b8; }
.empty-icon { color: #e2e8f0; margin-bottom: 20px; }
.empty-state h3 { color: #1e293b; margin: 0 0 10px; font-size: 1.5rem; }
.primary-btn { background: var(--primary); color: white; border: none; padding: 12px 24px; border-radius: 30px; font-weight: 600; cursor: pointer; margin-top: 20px; transition: 0.2s; }
.primary-btn:hover { transform: translateY(-2px); }

/* ANIMATIONS */
@keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
@keyframes slideUp { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
.animate-spin { animation: spin 1s linear infinite; }
@keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
.icon-pulse { animation: pulse 2s infinite; }
@keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.1); } 100% { transform: scale(1); } }

/* Single Card */
.single-card-wrapper { max-width: 500px; margin: 0 auto; }
.single-card-wrapper.next {
  animation: slideInRight 0.4s cubic-bezier(0.16, 1, 0.3, 1);
}
.single-card-wrapper.prev {
  animation: slideInLeft 0.4s cubic-bezier(0.16, 1, 0.3, 1);
}

@keyframes slideInRight {
  from { opacity: 0; transform: translateX(50px) scale(0.95); }
  to { opacity: 1; transform: translateX(0) scale(1); }
}

@keyframes slideInLeft {
  from { opacity: 0; transform: translateX(-50px) scale(0.95); }
  to { opacity: 1; transform: translateX(0) scale(1); }
}

/* MODAL STYLES */
.modal-overlay { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.3); backdrop-filter: blur(5px); display: flex; align-items: center; justify-content: center; z-index: 1000; animation: fadeIn 0.2s ease-out; }
.modal-box { background: white; width: 90%; max-width: 420px; border-radius: 20px; padding: 0; overflow: hidden; box-shadow: 0 25px 50px rgba(0,0,0,0.15); transform: translateY(0); animation: slideUp 0.3s ease-out; border: 1px solid #f1f5f9; }
.modal-header { display: flex; justify-content: space-between; align-items: center; padding: 20px 30px; border-bottom: 1px solid #f1f5f9; background: #fff; }
.modal-header h2 { margin: 0; font-size: 1.4rem; color: #1e293b; font-weight: 700; }
.close-icon { background: #f1f5f9; border: none; cursor: pointer; color: #64748b; padding: 8px; border-radius: 50%; transition: 0.2s; display: flex; align-items: center; justify-content: center; }
.close-icon:hover { background: #e2e8f0; color: #ef4444; }
.modal-body { padding: 30px; }

/* Profile View */
.profile-view { text-align: center; }
.profile-view .large-avatar { width: 90px; height: 90px; margin: 0 auto 20px; background: linear-gradient(135deg, #2563eb 0%, #4f46e5 100%); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 2.5rem; font-weight: bold; box-shadow: 0 10px 30px rgba(37, 99, 235, 0.2); }
.profile-view h3 { margin: 0; color: #1e293b; font-size: 1.6rem; font-weight: 700; }
.email-text { color: #64748b; margin: 5px 0 25px; font-size: 1rem; }
.stats-row { display: flex; justify-content: center; gap: 40px; margin-top: 25px; padding-top: 25px; border-top: 1px solid #f1f5f9; }
.stat-item { display: flex; flex-direction: column; align-items: center; }
.stat-val { font-weight: 800; font-size: 1.4rem; color: var(--primary); }
.stat-label { font-size: 0.85rem; color: #94a3b8; text-transform: uppercase; letter-spacing: 1px; font-weight: 600; margin-top: 5px; }

/* Settings View */
.setting-item { display: flex; justify-content: space-between; align-items: center; padding: 18px 0; border-bottom: 1px solid #f1f5f9; font-weight: 500; color: #334155; font-size: 1.05rem; }
.setting-item:last-child { border-bottom: none; }
.setting-item input[type="checkbox"] { width: 44px; height: 24px; position: relative; appearance: none; background: #e2e8f0; outline: none; border-radius: 12px; transition: .5s; cursor: pointer; box-shadow: inset 0 0 5px rgba(0,0,0,0.1); }
.setting-item input[type="checkbox"]:checked { background: var(--primary); }
.setting-item input[type="checkbox"]:before { content: ''; width: 20px; height: 20px; border-radius: 50%; position: absolute; top: 2px; left: 2px; background: #fff; transform: scale(1); transition: .5s; box-shadow: 0 2px 5px rgba(0,0,0,0.2); }
.setting-item input[type="checkbox"]:checked:before { left: 22px; }
.version-text { text-align: center; color: #cbd5e1; font-size: 0.85rem; margin-top: 30px; font-weight: 500; }

/* Help View */
.help-view { text-align: center; }
.help-view p { color: #64748b; font-size: 1.1rem; margin-bottom: 20px; }
.contact-box { background: #f8fafc; padding: 20px; border-radius: 12px; margin-top: 15px; border: 1px solid #e2e8f0; display: flex; justify-content: space-between; align-items: center; }
.contact-box strong { color: #475569; }
.contact-box a { color: var(--primary); text-decoration: none; font-weight: 700; transition: 0.2s; }
.contact-box a:hover { text-decoration: underline; }

/* --- DARK MODE OVERRIDES --- */
body.dark-mode { background-color: #0f172a; color: #f1f5f9; }
body.dark-mode .sidebar { background: #1e293b; border-color: #334155; }
body.dark-mode .nav-item { color: #94a3b8; }
body.dark-mode .nav-item:hover { background: #334155; color: #fff; }
body.dark-mode .nav-item.active { background: #334155; color: #818cf8; }
body.dark-mode .user-profile:hover { background: #334155; }
body.dark-mode .user-name { color: #f1f5f9; }
body.dark-mode .page-header h2 { color: #f1f5f9; }
body.dark-mode .page-header.left-align { border-color: #334155; }
body.dark-mode .user-dropdown { background: #1e293b; border-color: #334155; }
body.dark-mode .dropdown-item { color: #cbd5e1; }
body.dark-mode .dropdown-item:hover { background: #334155; color: #fff; }
body.dark-mode .dropdown-divider { background: #334155; }

body.dark-mode .create-card-wrapper { background: #1e293b; }
body.dark-mode textarea { background: #0f172a; border-color: #334155; color: #f1f5f9; }
body.dark-mode textarea:focus { border-color: #818cf8; }
body.dark-mode .slider-container { background: #0f172a; }
body.dark-mode .slider-label { color: #cbd5e1; }
body.dark-mode .slider-container input[type="range"] { background: #334155; }

body.dark-mode .deck-card { background: #1e293b; border-color: #334155; }
body.dark-mode .deck-card:hover { border-color: #818cf8; }
body.dark-mode .deck-title { color: #f1f5f9; }
body.dark-mode .deck-icon { background: #0f172a; }
body.dark-mode .delete-btn:hover { background: #450a0a; }

body.dark-mode .back-btn { background: #1e293b; border-color: #334155; color: #cbd5e1; }
body.dark-mode .back-btn:hover { background: #334155; color: #fff; }
body.dark-mode .study-title { color: #f1f5f9; }
body.dark-mode .flashcard.front { background: #1e293b; border-color: #334155; }
body.dark-mode .tap-hint { color: #64748b; }
body.dark-mode .nav-btn { background: #1e293b; color: #f1f5f9; }
body.dark-mode .nav-btn:hover:not(:disabled) { background: #334155; }

/* Modal Dark Mode */
body.dark-mode .modal-box { background: #1e293b; border-color: #334155; }
body.dark-mode .modal-header { background: #1e293b; border-color: #334155; }
body.dark-mode .modal-header h2 { color: #f1f5f9; }
body.dark-mode .close-icon { background: #334155; color: #94a3b8; }
body.dark-mode .close-icon:hover { background: #ef4444; color: #fff; }
body.dark-mode .stat-label { color: #94a3b8; }
body.dark-mode .stat-val { color: #818cf8; }
body.dark-mode .stats-row { border-color: #334155; }
body.dark-mode .profile-view h3 { color: #f1f5f9; }
body.dark-mode .setting-item { border-color: #334155; color: #f1f5f9; }
body.dark-mode .setting-item input[type="checkbox"] { background: #334155; }
body.dark-mode .setting-item input[type="checkbox"]:checked { background: #818cf8; }
body.dark-mode .contact-box { background: #0f172a; border-color: #334155; }
body.dark-mode .contact-box strong { color: #cbd5e1; }
body.dark-mode .contact-box a { color: #818cf8; }

/* Mobile Responsiveness */
@media (max-width: 768px) {
  .app-layout { flex-direction: column; }
  
  /* Sidebar becomes Bottom Nav */
  .sidebar {
    position: fixed;
    bottom: 0;
    left: 0;
    width: 100%;
    height: auto;
    flex-direction: row;
    justify-content: space-around;
    padding: 10px 20px;
    border-right: none;
    border-top: 1px solid #e2e8f0;
    box-shadow: 0 -4px 20px rgba(0,0,0,0.05);
    z-index: 1000;
  }

  .sidebar-top { display: none; }

  .nav-links {
    flex-direction: row;
    flex: 1;
    justify-content: space-around;
  }
  
  .nav-item {
    flex-direction: column;
    gap: 4px;
    font-size: 0.75rem;
    padding: 5px;
    border-radius: 8px;
  }

  /* Profile in Bottom Bar */
  .sidebar-bottom {
    border-top: none;
    padding-top: 0;
    margin-left: 10px;
    position: static;
  }
  
  .user-profile { padding: 0; gap: 0; }
  .user-info, .user-chevron { display: none; }
  
  .user-dropdown {
    bottom: 70px;
    left: auto;
    right: 10px;
    width: 200px;
  }

  .main-content {
    padding: 20px;
    padding-bottom: 90px;
    width: 100%;
  }

  .mobile-top-bar { display: flex; }

  .auth-content { flex-direction: column; gap: 30px; text-align: center; }
  .auth-header h1 { font-size: 3rem; }
  .auth-form-box { padding: 30px; width: 100%; }

  .deck-grid { grid-template-columns: 1fr; }
  
  .flashcard { height: 50vh; }
  .study-controls { gap: 15px; }
  
  .controls-row { flex-direction: column; align-items: stretch; }
  .slider-container { width: 100%; }
  
  /* Fix Modal on Mobile */
  .modal-box { width: 95%; max-width: none; }
}
